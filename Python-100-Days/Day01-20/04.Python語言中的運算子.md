##  Python語言中的運算子

Python 語言支援很多種運算子，下面的表格按照運算子的優先順序從高到低，對 Python 中的運算子進行了羅列。有了變數和運算子，我們就可以構造各種各樣的表示式來解決實際問題。在電腦科學中，**表示式是計算機程式中的句法實體，它由一個或多個常量、變數、函式和運算子組合而成，程式語言可以對其進行解釋和計算以得到另一個值**。不理解這句話沒有關係，但是一定要知道，不管使用什麼樣的程式語言，構造表示式都是非常重要的。

| 運算子                                                       | 描述                           |
| ------------------------------------------------------------ | ------------------------------ |
| `[]`、`[:]`                                                 | 索引、切片                  |
| `**`                                                         | 冪                             |
| `~`、`+`、`-`                                              | 按位取反、正號、負號         |
| `*`、`/`、`%`、`//`                                       | 乘、除、模、整除            |
| `+`、`-`                                                    | 加、減                        |
| `>>`、`<<`                                                  | 右移、左移                    |
| `&`                                                          | 按位與                         |
| `^`、`|`                                                   | 按位異或、按位或              |
| `<=`、`<`、`>`、`>=`                                      | 小於等於、小於、大於、大於等於 |
| `==`、`!=`                                                   | 等於、不等於                  |
| `is`、`is not`                                               | 身份運算子                     |
| `in`、`not in`                                                | 成員運算子                     |
| `not`、`or`、`and`                                             | 邏輯運算子                     |
| `=`、`+=`、`-=`、`*=`、`/=`、`%=`、`//=`、`**=`、`&=`、`\|=`、`^=`、`>>=`、`<<=` | 賦值運算子             |

>**說明**： 所謂優先順序就是在一個運算的表示式中，如果出現了多個運算子，應該先執行什麼再執行什麼的順序。編寫程式碼的時候，如果搞不清楚一個表示式中運算子的優先順序，可以使用圓括號（小括號）來確保運算的執行順序。

### 算術運算子

Python 中的算術運算子非常豐富，除了大家最為熟悉的加、減、乘、除之外，還有整除運算子、求模（求餘數）運算子和求冪運算子。下面的例子為大家展示了算術運算子的使用。

```python
"""
算術運算子

Version: 1.0
Author: Kevin
"""
print(321 + 12)     # 加法運算，輸出333
print(321 - 12)     # 減法運算，輸出309
print(321 * 12)     # 乘法運算，輸出3852
print(321 / 12)     # 除法運算，輸出26.75
print(321 // 12)    # 整除運算，輸出26
print(321 % 12)     # 求模運算，輸出9
print(321 ** 12)    # 求冪運算，輸出1196906950228928915420617322241
```

算術運算需要先乘除後加減，這一點跟數學課本中講的知識沒有區別，也就是說乘除法的運算優先順序是高於加減法的。如果還有求冪運算，求冪運算的優先順序是高於乘除法的。如果想改變算術運算的執行順序，可以使用英文輸入法狀態下的圓括號（小括號），寫在圓括號中的表示式會被優先執行，如下面的例子所示。

```python
"""
算術運算的優先順序

Version: 1.0
Author: Kevin
"""
print(2 + 3 * 5)           # 17
print((2 + 3) * 5)         # 25
print((2 + 3) * 5 ** 2)    # 125
print(((2 + 3) * 5) ** 2)  # 625
```

### 賦值運算子

賦值運算子應該是最為常見的運算子，它的作用是將右邊的值賦給左邊的變數。賦值運算子還可以跟上面的算術運算子放在一起，組合成複合賦值運算子，例如：`a += b`相當於`a = a + b`，`a *= a + 2`相當於`a = a * (a + 2)`。下面的例子演示了賦值運算子和複合賦值運算子的使用。

```python
"""
賦值運算子和複合賦值運算子

Version: 1.0
Author: Kevin
"""
a = 10
b = 3
a += b        # 相當於：a = a + b
a *= a + 2    # 相當於：a = a * (a + 2)
print(a)      # 大家算一下這裡會輸出什麼
```

賦值運算構成的表示式本身不產生任何值，也就是說，如果你把一個賦值表示式放到`print`函式中試圖輸出表示式的值，將會產生語法錯誤。為了解決這個問題，Python 3.8 中引入了一個新的賦值運算子`:=`，我們稱之為海象運算子，大家可以猜一猜它為什麼叫這個名字。海象運算子也是將運算子右側的值賦值給左邊的變數，與賦值運算子不同的是，運算子右側的值也是整個表示式的值，看看下面的程式碼大家就明白了。

```python
"""
海象運算子

Version: 1.0
Author: Kevin
"""
# SyntaxError: invalid syntax
# print((a = 10))
# 海象運算子
print((a := 10))  # 10
print(a)          # 10
```

> **提示**：上面第 8 行程式碼如果不註釋掉，執行程式碼會看到`SyntaxError: invalid syntax`錯誤資訊，注意，這行程式碼中我們給`a = 10`加上了圓括號，如果不小心寫成了`print(a = 10)`，會看到`TypeError: 'a' is an invalid keyword argument for print()`錯誤資訊，後面講到函式的時候，大家就會明白這個錯誤提示是什麼意思了。

### 比較運算子和邏輯運算子

比較運算子也稱為關係運算子，包括`==`、`!=`、`<`、`>`、`<=`、`>=`，我相信大家一看就能懂。需要提醒的是比較相等用的是`==`，請注意這裡是兩個等號，因為`=`是賦值運算子，我們在上面剛剛講到過。比較不相等用的是`!=`，跟數學課本中使用的$\small{\neq}$並不相同，Python 2 中曾經使用過`<>`來表示不等於，在 Python 3 中使用`<>`會引發`SyntaxError`（語法錯誤）。比較運算子會產生布林值，要麼是`True`，要麼是`False`。

邏輯運算子有三個，分別是`and`、`or`和`not`。`and`字面意思是“而且”，所以`and`運算子會連線兩個布林值或者產生布林值的表示式，如果兩邊的布林值都是`True`，那麼運算的結果就是`True`；左右兩邊的布林值有一個是`False`，最終的運算結果就是`False`。當然，如果`and`運算子左邊的布林值是`False`，不管右邊的布林值是什麼，最終的結果都是`False`，這時運算子右邊的布林值會被跳過（專業的說法叫短路處理，如果`and`右邊是一個表示式，那麼這個表示式不會執行）。`or`字面意思是“或者”，所以`or`運算子也會連線兩個布林值或產生布林值的表示式，如果兩邊的布林值有任意一個是`True`，那麼最終的結果就是`True`。當然，`or`運算子也是有短路功能的，當它左邊的布林值為`True`的情況下，右邊的布林值會被短路（如果`or`右邊是一個表示式，那麼這個表示式不會執行）。`not`運算子的後面可以跟一個布林值，如果`not`後面的布林值或表示式是`True`，那麼運算的結果就是`False`；如果`not`後面的布林值或表示式是`False`，那麼運算的結果就是`True`。

```python
"""
比較運算子和邏輯運算子的使用

Version: 1.0
Author: Kevin
"""
flag0 = 1 == 1
flag1 = 3 > 2
flag2 = 2 < 1
flag3 = flag1 and flag2
flag4 = flag1 or flag2
flag5 = not flag0
print('flag0 =', flag0)     # flag0 = True
print('flag1 =', flag1)     # flag1 = True
print('flag2 =', flag2)     # flag2 = False
print('flag3 =', flag3)     # flag3 = False
print('flag4 =', flag4)     # flag4 = True
print('flag5 =', flag5)     # flag5 = False
print(flag1 and not flag2)  # True
print(1 > 2 or 2 == 3)      # False
```

> **說明**：比較運算子的優先順序高於賦值運算子，所以上面的`flag0 = 1 == 1`先做`1 == 1`產生布林值`True`，再將這個值賦值給變數`flag0`。`print`函式可以輸出多個值，多個值之間可以用`,`進行分隔，輸出的內容預設以空格分開。

### 運算子和表示式應用

#### 例子1：華氏溫度轉攝氏溫度

> **要求**：輸入華氏溫度將其轉換為攝氏溫度，華氏溫度到攝氏溫度的轉換公式為： $\small{C = (F - 32) / 1.8}$ 。

```python
"""
將華氏溫度轉換為攝氏溫度

Version: 1.0
Author: Kevin
"""
f = float(input('請輸入華氏溫度: '))
c = (f - 32) / 1.8
print('%.1f華氏度 = %.1f攝氏度' % (f, c))
```

> **說明**：上面程式碼中的`input`函式用於從鍵盤接收使用者輸入，由於輸入的都是字串，如果想處理成浮點小數來做後續的運算，可以用我們上一課講解的型別轉換的方法，用`float`函式將`str`型別處理成`float`型別。

上面的程式碼中，我們對`print`函式輸出的內容進行了格式化處理，`print`輸出的字串中有兩個`%.1f`佔位符，這兩個佔位符會被`%`之後的`(f, c)`中的兩個`float`型別的變數值給替換掉，浮點數小數點後保留1位有效數字。如果字串中有`%d`佔位符，那麼我們會用`int`型別的值替換掉它，如果字串中有`%s`佔位符，那麼它會被`str`型別的值替換掉。

除了上面格式化輸出的方式外，Python 中還可以用下面的辦法來格式化輸出，我們給出一個帶佔位符的字串，字串前面的`f`表示這個字串是需要格式化處理的，其中的`{f:.1f}`和`{c:.1f}`可以先看成是`{f}`和`{c}`，表示輸出時會用變數`f`和變數`c`的值替換掉這兩個佔位符，後面的`:.1f`表示這是一個浮點數，小數點後保留1位有效數字。

```python
"""
將華氏溫度轉換為攝氏溫度

Version: 1.1
Author: Kevin
"""
f = float(input('請輸入華氏溫度: '))
c = (f - 32) / 1.8
print(f'{f:.1f}華氏度 = {c:.1f}攝氏度')
```

#### 例子2：計算圓的周長和麵積

> **要求**：輸入一個圓的半徑（$\small{r}$），計算出它的周長（ $\small{2 \pi r}$ ）和麵積（ $\small{\pi r^{2}}$ ）。

```python
"""
輸入半徑計算圓的周長和麵積

Version: 1.0
Author: Kevin
"""
radius = float(input('請輸入圓的半徑: '))
perimeter = 2 * 3.1416 * radius
area = 3.1416 * radius * radius
print('周長: %.2f' % perimeter)
print('面積: %.2f' % area)
```

Python 中有一個名為`math` 的內建模組，該模組中定義了名為`pi`的變數，它的值就是圓周率。如果要使用 Python 內建的這個`pi`，我們可以對上面的程式碼稍作修改。

```python
"""
輸入半徑計算圓的周長和麵積

Version: 1.1
Author: Kevin
"""
import math

radius = float(input('請輸入圓的半徑: '))
perimeter = 2 * math.pi * radius
area = math.pi * radius ** 2
print(f'周長: {perimeter:.2f}')
print(f'面積: {area:.2f}')
```

> **說明**：上面程式碼中的`import math`表示匯入`math`模組，匯入該模組以後，才能用`math.pi`得到圓周率的值。

這裡其實還有一種格式化輸出的方式，是 Python 3.8 中增加的新特性，大家直接看下面的程式碼就明白了。

```python
"""
輸入半徑計算圓的周長和麵積

Version: 1.2
Author: Kevin
"""
import math

radius = float(input('請輸入圓的半徑: '))  # 輸入: 5.5
perimeter = 2 * math.pi * radius
area = math.pi * radius ** 2
print(f'{perimeter = :.2f}')  # 輸出：perimeter = 34.56
print(f'{area = :.2f}')       # 輸出：area = 95.03
```

> **說明**：假如變數`a`的值是`9.87`，那麼字串`f'{a = }'`的值是`a = 9.87`；而字串`f'{a = :.1f}'`的值是`a = 9.9`。這種格式化輸出的方式會同時輸出變數名和變數值。

#### 例子3：判斷閏年

要求：輸入一個 1582 年以後的年份，判斷該年份是不是閏年。

```python
"""
輸入年份，閏年輸出True，平年輸出False

Version: 1.0
Author: Kevin
"""
year = int(input('請輸入年份: '))
is_leap = year % 4 == 0 and year % 100 != 0 or year % 400 == 0
print(f'{is_leap = }')
```

> **說明**：對於格里曆（Gregorian calendar），即今天我們使用的公曆，判斷閏年的規則是：1. 公元年份非 4 的倍數是平年；2. 公元年份為 4 的倍數但非 100 的倍數是閏年；3. 公元年份為 400 的倍數是閏年。格里曆是由教皇格里高利十三世在 1582 年 10 月引入的，作為對儒略曆（Julian calendar）的修改和替代，我們在輸入年份時要注意這一點。上面的程式碼透過`%`來判斷`year`是不是`4`的倍數、`100`的倍數、`400`的倍數，然後用`and`和`or`運算子將三個條件組裝在一起，前兩個條件要同時滿足，第三個條件跟前兩個條件的組合只需滿足其中之一。

### 總結

透過上面的講解和例子，相信大家已經感受到了運算子和表示式的力量。實際程式設計中的很多問題，都需透過構造表示式來解決，所以變數、運算子、表示式對於任何一門程式語言都是極為重要的基礎。如果本節課的內容有什麼不理解的地方，一定不要著急進入下一課，先在評論區留言討論，我會及時解答大家的問題。

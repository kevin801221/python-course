## 迴圈基礎

我們在寫程式的時候，極有可能遇到需要重複執行某條或某些指令的場景，例如我們需要每隔1秒鐘在螢幕上輸出一次"hello, world"並持續輸出一個小時。如下所示的程式碼可以完成一次這樣的操作，如果要持續輸出一個小時，我們就需要把這段程式碼寫3600遍，你願意這麼做嗎？

```python
import time

print('hello, world')
time.sleep(1)
```

> **說明**：Python 內建`time`模組的`sleep`函式可以實現程式的休眠，引數`1`表示休眠的秒數，可以使用`int`或`float`型別，例如`0.05`表示`50`毫秒。關於函式和模組的知識，我們在後續的課程中會為大家講解。

為了應對上述場景中的問題，我們可以在 Python 程式中使用迴圈結構。所謂迴圈結構，就是程式中控制某條或某些指令重複執行的結構。有了這樣的結構，剛才的程式碼就不需要寫 3600 遍，而是寫一遍然後放到迴圈結構中重複 3600 次。在 Python 語言中構造迴圈結構有兩種做法，一種是`for-in`迴圈，另一種是`while`迴圈。

### for-in迴圈

如果明確知道迴圈執行的次數，我們推薦使用`for-in`迴圈，例如上面說的那個重複 3600 次的場景，我們可以用下面的程式碼來實現。 注意，被`for-in`迴圈控制的程式碼塊也是透過縮排的方式來構造，這一點跟分支結構中構造程式碼塊的做法是一樣的。我們被`for-in`迴圈控制的程式碼塊稱為迴圈體，通常迴圈體中的語句會根據迴圈的設定被重複執行。

```python
"""
每隔1秒輸出一次"hello, world"，持續1小時

Author: Kevin
Version: 1.0
"""
import time

for i in range(3600):
    print('hello, world')
    time.sleep(1)
```

需要說明的是，上面程式碼中的`range(3600)`可以構造出一個從`0`到`3599`的範圍，當我們把這樣一個範圍放到`for-in`迴圈中，就可以透過前面的迴圈變數`i`依次取出從`0`到`3599`的整數，這就會讓`for-in`程式碼塊中的語句重複 3600 次。當然，`range`的用法非常靈活，下面的清單給出了使用`range`函式的例子：

- `range(101)`：可以用來產生`0`到`100`範圍的整數，需要注意的是取不到`101`。
- `range(1, 101)`：可以用來產生`1`到`100`範圍的整數，相當於是左閉右開的設定，即`[1, 101)`。
- `range(1, 101, 2)`：可以用來產生`1`到`100`的奇數，其中`2`是步長（跨度），即每次遞增的值，`101`取不到。
- `range(100, 0, -2)`：可以用來產生`100`到`1`的偶數，其中`-2`是步長（跨度），即每次遞減的值，`0`取不到。

大家可能已經注意到了，上面程式碼的輸出操作和休眠操作都沒有用到迴圈變數`i`，對於不需要用到迴圈變數的`for-in`迴圈結構，按照 Python 的程式設計慣例，我們通常把迴圈變數命名為`_`，修改後的程式碼如下所示。雖然結果沒什麼變化，但是這樣寫顯得你更加專業，逼格瞬間拉滿。

```python
"""
每隔1秒輸出一次"hello, world"，持續1小時

Author: Kevin
Version: 1.1
"""
import time

for _ in range(3600):
    print('hello, world')
    time.sleep(1)
```

上面的程式碼要執行一個小時，如果想提前結束程式，在 PyCharm 中可以點選執行視窗上的停止按鈕，如下圖所示。如果在命令提示符或終端中執行程式碼，可以使用組合鍵`ctrl+c`來終止程式。

<img src="../../res/day06/terminate_program.png" style="zoom:40%;">

下面，我們用`for-in`迴圈實現從 1 到 100 的整數求和，即 $\small{\sum_{n=1}^{100}{n}}$ 。

```python
"""
從1到100的整數求和

Version: 1.0
Author: Kevin
"""
total = 0
for i in range(1, 101):
    total += i
print(total)
```

上面的程式碼中，變數`total`的作用是儲存累加的結果。在迴圈的過程中，迴圈變數`i`的值會從 1 一直取到 100。對於變數`i`的每個取值，我們都執行了`total += i`，它相當於`total = total + i`，這條語句實現了累加操作。所以，當迴圈結束，我們輸出變數`total` 的值，它的值就是從 1 累加到 100 的結果 5050。注意，`print(total)`這條語句前是沒有縮排的，它不受`for-in`迴圈的控制，不會重複執行。

我們再來寫一個從1到100偶數求和的程式碼，如下所示。

```python
"""
從1到100的偶數求和

Version: 1.0
Author: Kevin
"""
total = 0
for i in range(1, 101):
    if i % 2 == 0:
        total += i
print(total)
```

> **說明**：上面的`for-in`迴圈中我們使用了分支結構來判斷迴圈變數`i`是不是偶數。

我們也可以修改`range`函式的引數，將起始值和跨度修改為`2`，用更為簡單的程式碼實現從 1 到 100 的偶數求和。

```python
"""
從1到100的偶數求和

Version: 1.1
Author: Kevin
"""
total = 0
for i in range(2, 101, 2):
    total += i
print(total)
```

當然， 更為簡單的辦法是使用 Python 內建的`sum`函式求和，這樣我們連迴圈結構都省掉了。

```python
"""
從1到100的偶數求和

Version: 1.2
Author: Kevin
"""
print(sum(range(2, 101, 2)))
```

### while迴圈

如果要構造迴圈結構但是又不能確定迴圈重複的次數，我們推薦使用`while`迴圈。`while`迴圈透過布林值或能產生布林值的表示式來控制迴圈，當布林值或表示式的值為`True`時，迴圈體（`while`語句下方保持相同縮排的程式碼塊）中的語句就會被重複執行，當表示式的值為`False`時，結束迴圈。

下面我們用`while`迴圈來實現從 1 到 100 的整數求和，程式碼如下所示。

```python
"""
從1到100的整數求和

Version: 1.1
Author: Kevin
"""
total = 0
i = 1
while i <= 100:
    total += i
    i += 1
print(total)
```

相較於`for-in`迴圈，上面的程式碼我們在迴圈開始前增加了一個變數`i`，我們使用這個變數來控制迴圈，所以`while`後面給出了`i <= 100`的條件。在`while`的迴圈體中，我們除了做累加，還需要讓變數`i`的值遞增，所以我們新增了`i += 1`這條語句，這樣`i`的值就會依次取到1、2、3、……，直到 101。當`i`變成 101 時，`while`迴圈的條件不再成立，程式碼會離開`while`迴圈，此時我們輸出變數`total`的值，它就是從 1 到 100 求和的結果 5050。

如果要實現從 1 到 100 的偶數求和，我們可以對上面的程式碼稍作修改。

```python
"""
從1到100的偶數求和

Version: 1.3
Author: Kevin
"""
total = 0
i = 2
while i <= 100:
    total += i
    i += 2
print(total)
```

### 總結

透過這節課的學習，大家應該已經知道了可以用`for`和`while`關鍵字來構造迴圈結構。**如果事先知道迴圈結構重複的次數，我們通常使用`for`迴圈**；**如果迴圈結構的重複次數不能確定，可以用`while`迴圈**。下一節我們將學習`break`、`continue`關鍵字以及迴圈的進階應用。

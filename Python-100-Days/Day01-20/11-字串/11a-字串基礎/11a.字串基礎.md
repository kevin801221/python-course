## 字串基礎

第二次世界大戰促使了現代電子計算機的誕生，世界上的第一臺通用電子計算機名叫 ENIAC（電子數值積分計算機），誕生於美國的賓夕法尼亞大學，佔地 167 平米，重量約 27 噸，每秒鐘大約能夠完成約 5000 次浮點運算，如下圖所示。ENIAC 誕生之後被應用於導彈彈道的計算，而數值計算也是現代電子計算機最為重要的一項功能。

<img src="../../res/day11/eniac.jpg" style="zoom:50%;">

隨著時間的推移，雖然數值運算仍然是計算機日常工作中最為重要的組成部分，但是今天的計算機還要處理大量的以文字形式存在的資訊。如果我們希望透過 Python 程式來操作本這些文字資訊，就必須要先了解字串這種資料型別以及與它相關的運算和方法。

### 字串的定義

所謂**字串**，就是**由零個或多個字元組成的有限序列**，一般記為：

$$
s = a_1a_2 \cdots a_n \,\,\,\,\, (0 \le n \le \infty)
$$

在 Python 程式中，我們把單個或多個字元用單引號或者雙引號包圍起來，就可以表示一個字串。字串中的字元可以是特殊符號、英文字母、中文字元、日文的平假名或片假名、希臘字母、Emoji 字元（如：💩、🐷、🀄️）等。

```python
s1 = 'hello, world!'
s2 = "你好，世界！❤️"
s3 = '''hello,
wonderful
world!'''
print(s1)
print(s2)
print(s3)
```

#### 跳脫字元

我們可以在字串中使用`\`（反斜槓）來表示轉義，也就是說`\`後面的字元不再是它原來的意義，例如：`\n`不是代表字元`\`和字元`n`，而是表示換行；`\t`也不是代表字元`\`和字元`t`，而是表示製表符。所以如果字串本身又包含了`'`、`"`、`\`這些特殊的字元，必須要透過`\`進行轉義處理。例如要輸出一個帶單引號或反斜槓的字串，需要用如下所示的方法。

```python
s1 = '\'hello, world!\''
s2 = '\\hello, world!\\'
print(s1)
print(s2)
```

#### 原始字串

Python 中有一種以`r`或`R`開頭的字串，這種字串被稱為原始字串，意思是字串中的每個字元都是它本來的含義，沒有所謂的跳脫字元。例如，在字串`'hello\n'`中，`\n`表示換行；而在`r'hello\n'`中，`\n`不再表示換行，就是字元`\`和字元`n`。大家可以執行下面的程式碼，看看會輸出什麼。

```python
s1 = '\it \is \time \to \read \now'
s2 = r'\it \is \time \to \read \now'
print(s1)
print(s2)
```

> **說明**：上面的變數`s1`中，`\t`、`\r`和`\n`都是跳脫字元。`\t`是製表符（table），`\n`是換行符（new line），`\r`是回車符（carriage return）相當於讓輸出回到了行首。對比一下兩個`print`函式的輸出，看看到底有什麼區別！

#### 字元的特殊表示

Python 中還允許在`\`後面還可以跟一個八進位制或者十六進位制數來表示字元，例如`\141`和`\x61`都代表小寫字母`a`，前者是八進位制的表示法，後者是十六進位制的表示法。另外一種表示字元的方式是在`\u`後面跟 Unicode 字元編碼，例如`\u9a86\u660a`代表的是中文"Kevin"。執行下面的程式碼，看看輸出了什麼。

```python
s1 = '\141\142\143\x61\x62\x63'
s2 = '\u9a86\u660a'
print(s1)
print(s2)
```

### 字串的運算

Python 語言為字串型別提供了非常豐富的運算子，有很多運算子跟列表型別的運算子作用類似。例如，我們可以使用`+`運算子來實現字串的拼接，可以使用`*`運算子來重複一個字串的內容，可以使用`in`和`not in`來判斷一個字串是否包含另外一個字串，我們也可以用`[]`和`[:]`運算子從字串取出某個字元或某些字元。

#### 拼接和重複

下面的例子演示了使用`+`和`*`運算子來實現字串的拼接和重複操作。

```python
s1 = 'hello' + ', ' + 'world'
print(s1)    # hello, world
s2 = '!' * 3
print(s2)    # !!!
s1 += s2
print(s1)    # hello, world!!!
s1 *= 2
print(s1)    # hello, world!!!hello, world!!!
```

用`*`實現字串的重複是非常有意思的一個運算子，在很多程式語言中，要表示一個有10個`a`的字串，你只能寫成`'aaaaaaaaaa'`，但是在 Python 中，你可以寫成`'a' * 10`。你可能覺得`'aaaaaaaaaa'`這種寫法也沒有什麼不方便的，但是請想一想，如果字元`a`要重複100次或者1000次又會如何呢？

#### 比較運算

對於兩個字串型別的變數，可以直接使用比較運算子來判斷兩個字串的相等性或比較大小。需要說明的是，因為字串在計算機記憶體中也是以二進位制形式存在的，那麼字串的大小比較比的是每個字元對應的編碼的大小。例如`A`的編碼是`65`， 而`a`的編碼是`97`，所以`'A' < 'a'`的結果相當於就是`65 < 97`的結果，這裡很顯然是`True`；而`'boy' < 'bad'`，因為第一個字元都是`'b'`比不出大小，所以實際比較的是第二個字元的大小，顯然`'o' < 'a'`的結果是`False`，所以`'boy' < 'bad'`的結果是`False`。如果不清楚兩個字元對應的編碼到底是多少，可以使用`ord`函式來獲得，之前我們有提到過這個函式。例如`ord('A')`的值是`65`，而`ord('昊')`的值是`26122`。下面的程式碼展示了字串的比較運算，請大家仔細看看。

```python
s1 = 'a whole new world'
s2 = 'hello world'
print(s1 == s2)             # False
print(s1 < s2)              # True
print(s1 == 'hello world')  # False
print(s2 == 'hello world')  # True
print(s2 != 'Hello world')  # True
s3 = 'Kevin'
print(ord('駱'))            # 39558
print(ord('昊'))            # 26122
s4 = '王大錘'
print(ord('王'))            # 29579
print(ord('大'))            # 22823
print(ord('錘'))            # 38180
print(s3 >= s4)             # True
print(s3 != s4)             # True
```

#### 成員運算

Python 中可以用`in`和`not in`判斷一個字串中是否包含另外一個字元或字串，跟列表型別一樣，`in`和`not in`稱為成員運算子，會產生布林值`True`或`False`，程式碼如下所示。

```python
s1 = 'hello, world'
s2 = 'goodbye, world'
print('wo' in s1)      # True
print('wo' not in s2)  # False
print(s2 in s1)        # False
```

#### 獲取字串長度

獲取字串長度跟獲取列表元素個數一樣，使用內建函式`len`，程式碼如下所示。

```python
s = 'hello, world'
print(len(s))                 # 12
print(len('goodbye, world'))  # 14
```

#### 索引和切片

字串的索引和切片操作跟列表、元組幾乎沒有區別，因為字串也是一種有序序列，可以透過正向或反向的整數索引訪問其中的元素。但是有一點需要注意，因為**字串是不可變型別**，所以**不能透過索引運算修改字串中的字元**。

```python
s = 'abc123456'
n = len(s)
print(s[0], s[-n])    # a a
print(s[n-1], s[-1])  # 6 6
print(s[2], s[-7])    # c c
print(s[5], s[-4])    # 3 3
print(s[2:5])         # c12
print(s[-7:-4])       # c12
print(s[2:])          # c123456
print(s[:2])          # ab
print(s[::2])         # ac246
print(s[::-1])        # 654321cba
```

需要再次提醒大家注意的是，在進行索引運算時，如果索引越界，會引發`IndexError`異常，錯誤提示資訊為：`string index out of range`（字串索引超出範圍）。

### 字元的遍歷

如果希望遍歷字串中的每個字元，可以使用`for-in`迴圈，有如下所示的兩種方式。

方式一：

```python
s = 'hello'
for i in range(len(s)):
    print(s[i])
```

方式二：

```python
s = 'hello'
for elem in s:
    print(elem)
```

### 總結

知道如何表示和操作字串對程式設計師來說是非常重要的，因為我們經常需要處理文字資訊。Python 中操作字串可以用拼接、索引、切片等運算子。下一節我們將學習字串型別提供的豐富方法。

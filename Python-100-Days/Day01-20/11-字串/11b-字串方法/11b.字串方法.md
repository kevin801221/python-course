## 字串的方法

在 Python 中，我們可以透過字串型別自帶的方法對字串進行操作和處理，假設我們有名為`foo`的字串，字串有名為`bar`的方法，那麼使用字串方法的語法是：`foo.bar()`，這是一種透過物件引用呼叫物件方法的語法，跟前面使用列表方法的語法是一樣的。

### 大小寫相關操作

下面的程式碼演示了和字串大小寫變換相關的方法。

```python
s1 = 'hello, world!'
# 字串首字母大寫
print(s1.capitalize())  # Hello, world!
# 字串每個單詞首字母大寫
print(s1.title())       # Hello, World!
# 字串變大寫
print(s1.upper())       # HELLO, WORLD!
s2 = 'GOODBYE'
# 字串變小寫
print(s2.lower())       # goodbye
# 檢查s1和s2的值
print(s1)               # hello, world
print(s2)               # GOODBYE
```

> **說明**：由於字串是不可變型別，使用字串的方法對字串進行操作會產生新的字串，但是原來變數的值並沒有發生變化。所以上面的程式碼中，當我們最後檢查`s1`和`s2`兩個變數的值時，`s1`和`s2` 的值並沒有發生變化。

### 查詢操作

如果想在一個字串中從前向後查詢有沒有另外一個字串，可以使用字串的`find`或`index`方法。在使用`find`和`index`方法時還可以透過方法的引數來指定查詢的範圍，也就是查詢不必從索引為`0`的位置開始。

```python
s = 'hello, world!'
print(s.find('or'))      # 8
print(s.find('or', 9))   # -1
print(s.find('of'))      # -1
print(s.index('or'))     # 8
print(s.index('or', 9))  # ValueError: substring not found
```

>**說明**：`find`方法找不到指定的字串會返回`-1`，`index`方法找不到指定的字串會引發`ValueError`錯誤。

`find`和`index`方法還有逆向查詢（從後向前查詢）的版本，分別是`rfind`和`rindex`，程式碼如下所示。

```python
s = 'hello world!'
print(s.find('o'))       # 4
print(s.rfind('o'))      # 7
print(s.rindex('o'))     # 7
# print(s.rindex('o', 8))  # ValueError: substring not found
```

### 性質判斷

可以透過字串的`startswith`、`endswith`來判斷字串是否以某個字串開頭和結尾；還可以用`is`開頭的方法判斷字串的特徵，這些方法都返回布林值，程式碼如下所示。

```python
s1 = 'hello, world!'
print(s1.startswith('He'))   # False
print(s1.startswith('hel'))  # True
print(s1.endswith('!'))      # True
s2 = 'abc123456'
print(s2.isdigit())  # False
print(s2.isalpha())  # False
print(s2.isalnum())  # True
```

> **說明**：上面的`isdigit`用來判斷字串是不是完全由數字構成的，`isalpha`用來判斷字串是不是完全由字母構成的，這裡的字母指的是 Unicode 字元但不包含 Emoji 字元，`isalnum`用來判斷字串是不是由字母和數字構成的。

### 格式化

在 Python 中，字串型別可以透過`center`、`ljust`、`rjust`方法做居中、左對齊和右對齊的處理。如果要在字串的左側補零，也可以使用`zfill`方法。

```python
s = 'hello, world'
print(s.center(20, '*'))  # ****hello, world****
print(s.rjust(20))        #         hello, world
print(s.ljust(20, '~'))   # hello, world~~~~~~~~
print('33'.zfill(5))      # 00033
print('-33'.zfill(5))     # -0033
```

我們之前講過，在用`print`函式輸出字串時，可以用下面的方式對字串進行格式化。

```python
a = 321
b = 123
print('%d * %d = %d' % (a, b, a * b))
```

當然，我們也可以用字串的`format`方法來完成字串的格式，程式碼如下所示。

```python
a = 321
b = 123
print('{0} * {1} = {2}'.format(a, b, a * b))
```

從 Python 3.6 開始，格式化字串還有更為簡潔的書寫方式，就是在字串前加上`f`來格式化字串，在這種以`f`打頭的字串中，`{變數名}`是一個佔位符，會被變數對應的值將其替換掉，程式碼如下所示。

```python
a = 321
b = 123
print(f'{a} * {b} = {a * b}')
```

如果需要進一步控制格式化語法中變數值的形式，可以參照下面的表格來進行字串格式化操作。

| 變數值      | 佔位符     | 格式化結果    | 說明 |
| ----------- | ---------- | ------------- | ---- |
| `3.1415926` | `{:.2f}`   | `'3.14'`      | 保留小數點後兩位 |
| `3.1415926` | `{:+.2f}`  | `'+3.14'`       | 帶符號保留小數點後兩位 |
| `-1`        | `{:+.2f}`  | `'-1.00'` | 帶符號保留小數點後兩位 |
| `3.1415926` | `{:.0f}`   | `'3'` | 不帶小數 |
| `123`       | `{:0>10d}` | `'0000000123'` | 左邊補`0`，補夠10位 |
| `123`       | `{:x<10d}` | `'123xxxxxxx'` | 右邊補`x` ，補夠10位 |
| `123`       | `{:>10d}`  | `'       123'` | 左邊補空格，補夠10位 |
| `123`       | `{:<10d}` | `'123       '` | 右邊補空格，補夠10位 |
| `123456789` | `{:,}`     | `'123,456,789'` | 逗號分隔格式 |
| `0.123`     | `{:.2%}`   | `'12.30%'`    | 百分比格式 |
| `123456789` | `{:.2e}`   | `'1.23e+08'`  | 科學計數法格式 |

### 修剪操作

字串的`strip`方法可以幫我們獲得將原字串修剪掉左右兩端指定字元之後的字串，預設是修剪空格字元。這個方法非常有實用價值，可以用來將使用者輸入時不小心鍵入的頭尾空格等去掉，`strip`方法還有`lstrip`和`rstrip`兩個版本，相信從名字大家已經猜出來這兩個方法是做什麼用的。

```python
s1 = '   jackfrued@126.com  '
print(s1.strip())      # jackfrued@126.com
s2 = '~你好，世界~'
print(s2.lstrip('~'))  # 你好，世界~
print(s2.rstrip('~'))  # ~你好，世界
```

### 替換操作

如果希望用新的內容替換字串中指定的內容，可以使用`replace`方法，程式碼如下所示。`replace`方法的第一個引數是被替換的內容，第二個引數是替換後的內容，還可以透過第三個引數指定替換的次數。

```python
s = 'hello, good world'
print(s.replace('o', '@'))     # hell@, g@@d w@rld
print(s.replace('o', '@', 1))  # hell@, good world
```

### 拆分與合併

可以使用字串的`split`方法將一個字串拆分為多個字串（放在一個列表中），也可以使用字串的`join`方法將列表中的多個字串連線成一個字串，程式碼如下所示。

```python
s = 'I love you'
words = s.split()
print(words)            # ['I', 'love', 'you']
print('~'.join(words))  # I~love~you
```

需要說明的是，`split`方法預設使用空格進行拆分，我們也可以指定其他的字元來拆分字串，而且還可以指定最大拆分次數來控制拆分的效果，程式碼如下所示。

```python
s = 'I#love#you#so#much'
words = s.split('#')
print(words)  # ['I', 'love', 'you', 'so', 'much']
words = s.split('#', 2)
print(words)  # ['I', 'love', 'you#so#much']
```

### 編碼和解碼

Python 中除了字串`str`型別外，還有一種表示二進位制資料的位元組串型別（`bytes`）。所謂位元組串，就是**由零個或多個位元組組成的有限序列**。透過字串的`encode`方法，我們可以按照某種編碼方式將字串編碼為位元組串，我們也可以使用位元組串的`decode`方法，將位元組串解碼為字串，程式碼如下所示。

```python
a = 'Kevin'
b = a.encode('utf-8')
c = a.encode('gbk')
print(b)                  # b'\xe9\xaa\x86\xe6\x98\x8a'
print(c)                  # b'\xc2\xe6\xea\xbb'
print(b.decode('utf-8'))  # Kevin
print(c.decode('gbk'))    # Kevin
```

注意，如果編碼和解碼的方式不一致，會導致亂碼問題（無法再現原始的內容）或引發`UnicodeDecodeError`錯誤，導致程式崩潰。

### 其他方法

對於字串型別來說，還有一個常用的操作是對字串進行匹配檢查，即檢查字串是否滿足某種特定的模式。例如，一個網站對使用者註冊資訊中使用者名稱和郵箱的檢查，就屬於模式匹配檢查。實現模式匹配檢查的工具叫做正規表示式，Python 語言透過標準庫中的`re`模組提供了對正規表示式的支援，我們會在後續的課程中為大家講解這個知識點。

### 總結

Python 中操作字串可以用拼接、索引、切片等運算子，也可以使用字串型別提供的非常豐富的方法，包括：

1. **大小寫**：`capitalize`、`title`、`upper`、`lower`
2. **查詢**：`find`、`rfind`、`index`、`rindex`
3. **判斷**：`startswith`、`endswith`、`isdigit`、`isalpha`、`isalnum`
4. **格式化**：`center`、`ljust`、`rjust`、`zfill`、`format`
5. **修剪**：`strip`、`lstrip`、`rstrip`
6. **替換**：`replace`
7. **拆分合併**：`split`、`join`
8. **編碼解碼**：`encode`、`decode`

## 函式基礎

在講解本節課的內容之前，我們先來研究一道數學題，請說出下面的方程有多少組正整數解。

$$
x_{1} + x_{2} + x_{3} + x_{4} = 8
$$

你可能已經想到了，這個問題其實等同於將 8 個蘋果分成四組且每組至少一個蘋果有多少種方案，也等價於在分隔 8 個蘋果的 7 個間隙之間放入三個隔斷將蘋果分成四組有多少種方案，所以答案是 $\small{C_{7}^{3} = 35}$ ，其中 $\small{C_{7}^{3}}$ 代表 7 選 3 的組合數，其計算公式如下所示。

$$
C_m^n = \frac {m!} {n!(m-n)!}
$$

根據之前學習的知識，我們可以用迴圈做累乘的方式分別計算出 $\small{m!}$ 、 $\small{n!}$ 和 $\small{(m-n)!}$ ，然後再透過除法運算得到組合數 $\small{C_{m}^{n}}$ ，程式碼如下所示。

```python
"""
輸入m和n，計算組合數C(m,n)的值

Version: 1.0
Author: Kevin
"""

m = int(input('m = '))
n = int(input('n = '))
# 計算m的階乘
fm = 1
for num in range(1, m + 1):
    fm *= num
# 計算n的階乘
fn = 1
for num in range(1, n + 1):
    fn *= num
# 計算m-n的階乘
fk = 1
for num in range(1, m - n + 1):
    fk *= num
# 計算C(M,N)的值
print(fm // fn // fk)
```

輸入：

```
m = 7
n = 3
```

輸出：

```
35
```

不知大家是否注意到，上面的程式碼中我們做了三次求階乘的操作，雖然 $\small{m}$ 、 $\small{n}$ 、 $\small{m - n}$ 的值各不相同，但是三段程式碼並沒有實質性的區別，屬於重複程式碼。世界級的程式設計大師*Martin Fowler*曾經說過："**程式碼有很多種壞味道，重複是最壞的一種！**"。要寫出高質量的程式碼，首先就要解決重複程式碼的問題。對於上面的程式碼來說，我們可以將求階乘的功能封裝到一個稱為"函式"的程式碼塊中，在需要計算階乘的地方，我們只需"呼叫函式"即可實現對求階乘功能的複用。

### 定義函式

數學上的函式通常形如 $\small{y = f(x)}$ 或者 $\small{z = g(x, y)}$ 這樣的形式，在 $\small{y = f(x)}$ 中， $\small{f}$ 是函式的名字， $\small{x}$ 是函式的自變數， $\small{y}$ 是函式的因變數；而在 $\small{z = g(x, y)}$ 中， $\small{g}$ 是函式名， $\small{x}$ 和 $\small{y}$ 是函式的自變數， $\small{z}$ 是函式的因變數。Python 中的函式跟這個結構是一致的，每個函式都有自己的名字、自變數和因變數。我們通常把 Python 函式的自變數稱為函式的引數，而因變數稱為函式的返回值。

Python 中可以使用`def`關鍵字來定義函式，和變數一樣每個函式也應該有一個漂亮的名字，命名規則跟變數的命名規則是一樣的（大家趕緊想想我們之前講過的變數的命名規則）。在函式名後面的圓括號中可以設定函式的引數，也就是我們剛才說的函式的自變數，而函式執行完成後，我們會透過`return`關鍵字來返回函式的執行結果，這就是我們剛才說的函式的因變數。如果函式中沒有`return`語句，那麼函式會返回代表空值的`None`。另外，函式也可以沒有自變數（引數），但是函式名後面的圓括號是必須有的。一個函式要做的事情（要執行的程式碼），是透過程式碼縮排的方式放到函式定義行之後，跟之前分支和迴圈結構的程式碼塊類似，如下圖所示。

<img src="../../res/day14/function_definition.png" style="zoom:45%;">

下面，我們將之前程式碼中求階乘的操作放到一個函式中，透過這種方式來重構上面的程式碼。**所謂重構，是在不影響程式碼執行結果的前提下對程式碼的結構進行調整**，重構之後的程式碼如下所示。

```python
"""
輸入m和n，計算組合數C(m,n)的值

Version: 1.1
Author: Kevin
"""


# 透過關鍵字def定義求階乘的函式
# 自變數（引數）num是一個非負整數
# 因變數（返回值）是num的階乘
def fac(num):
    result = 1
    for n in range(2, num + 1):
        result *= n
    return result


m = int(input('m = '))
n = int(input('n = '))
# 計算階乘的時候不需要寫重複的程式碼而是直接呼叫函式
# 呼叫函式的語法是在函式名後面跟上圓括號並傳入引數
print(fac(m) // fac(n) // fac(m - n))
```

大家可以感受下，上面的程式碼是不是比之前的版本更加簡單優雅。更為重要的是，我們定義的求階乘函式`fac`還可以在其他需要求階乘的程式碼中重複使用。所以，**使用函式可以幫助我們將功能上相對獨立且會被重複使用的程式碼封裝起來**，當我們需要這些的程式碼，不是把重複的程式碼再編寫一遍，而是**透過呼叫函式實現對既有程式碼的複用**。

### 使用標準庫函式

事實上，Python 標準庫的`math`模組中，已經有一個名為`factorial`的函式實現了求階乘的功能，我們可以直接用`import math`匯入`math`模組，然後使用`math.factorial`來呼叫求階乘的函式；我們也可以透過`from math import factorial`直接匯入`factorial`函式來使用它，程式碼如下所示。

```python
"""
輸入m和n，計算組合數C(m,n)的值

Version: 1.2
Author: Kevin
"""
from math import factorial

m = int(input('m = '))
n = int(input('n = '))
print(factorial(m) // factorial(n) // factorial(m - n))
```

將來我們使用的函式，要麼是自定義的函式，要麼是 Python 標準庫或者三方庫中提供的函式，如果已經有現成的可用的函式，我們就沒有必要自己去定義，"**重複發明輪子**"是一件非常糟糕的事情。對於上面的程式碼，如果你覺得`factorial`這個名字太長，書寫程式碼的時候不是特別方便，我們在匯入函式的時候還可以透過`as`關鍵字為其別名。在呼叫函式的時候，我們可以用函式的別名，而不再使用它之前的名字，程式碼如下所示。

```python
"""
輸入m和n，計算組合數C(m,n)的值

Version: 1.3
Author: Kevin
"""
from math import factorial as f

m = int(input('m = '))
n = int(input('n = '))
print(f(m) // f(n) // f(m - n))
```

### 總結

**函式是對功能相對獨立且會重複使用的程式碼的封裝**。學會定義和使用函式，就能夠寫出更為優質的程式碼。在 Python 中，使用`def`關鍵字定義函式，函式可以有引數和返回值。

## NumPy的應用-2

### 陣列物件的方法

#### 獲取描述統計資訊

描述統計資訊主要包括資料的集中趨勢、離散程度和頻數分析等，其中集中趨勢主要看均值和中位數，離散程度可以看極值、方差、標準差等。

```Python
array1 = np.random.randint(1, 100, 10)
array1
```

輸出：

```
array([46, 51, 15, 42, 53, 71, 20, 62,  6, 94])
```

**計算總和、均值和中位數。**

程式碼：

```Python
print(array1.sum())
print(np.sum(array1))
print(array1.mean())
print(np.mean(array1))
print(np.median(array1))
print(np.quantile(array1, 0.5))
```

> **說明**：上面程式碼中的`mean`、`median`和`quantile`分別是 NumPy 中計算算術平均值、中位數和分位數的函式，其中`quantitle`函式的第二個引數設定為0.5表示計算50%分位數，也就是中位數。

輸出：

```
460
460
46.0
46.0
48.5
48.5
```

**極值、全距和四分位距離。**

程式碼：

```Python
print(array1.max())
print(np.amax(array1))
print(array1.min())
print(np.amin(array1))
print(np.ptp(array1))
print(np.ptp(array1))
q1, q3 = np.quantile(array1, [0.25, 0.75])
print(q3 - q1)
```

輸出：

```
94
94
6
6
88
88
34.25
```

**方差、標準差和變異係數。**

程式碼：

```Python
print(array1.var())
print(np.var(array1))
print(array1.std())
print(np.std(array1))
print(array1.std() / array1.mean())
```

輸出：

```
651.2
651.2
25.51862065237853
25.51862065237853
0.5547526228777941
```

**繪製箱線圖。**

箱線圖又稱為盒須圖，是顯示一組資料分散情況的統計圖，因形狀如箱子而得名。 它主要用於反映原始資料分佈的特徵，還可以進行多組資料分佈特徵的比較。

程式碼：

```Python
plt.boxplot(array1, showmeans=True)
plt.ylim([-20, 120])
plt.show()
```

輸出：

<img src="res/box_plot_1.png" style="zoom:40%;">

值得注意的是，對於二維或更高維的陣列，在獲取描述統計資訊時，可以透過名為`axis`的引數指定均值、方差等運算是沿著哪一個軸來執行，`axis`引數不同，執行的結果可能是大相徑庭的，如下所示。

程式碼：

```Python
array2 = np.random.randint(60, 101, (5, 3))
array2
```

輸出：

```
array([[72, 64, 73],
       [61, 73, 61],
       [76, 85, 77],
       [97, 88, 90],
       [63, 93, 82]])
```

程式碼：

```Python
array2.mean()
```

輸出：

```
77.0
```

程式碼：

```Python
array2.mean(axis=0)
```

輸出：

```
array([73.8, 80.6, 76.6])
```

程式碼：

```Python
array2.mean(axis=1)
```

輸出：

```
array([69.66666667, 65.        , 79.33333333, 91.66666667, 79.33333333])
```

程式碼：

```Python
array2.max(axis=0)
```

輸出：

```
array([97, 93, 90])
```

程式碼：

```Python
array2.max(axis=1)
```

輸出：

```
array([73, 73, 85, 97, 93])
```

再看看繪製箱線圖，對於二維陣列每一列都會產生一個統計圖形，如下所示。

程式碼：

```Python
plt.boxplot(array2, showmeans=True)
plt.ylim([-20, 120])
plt.show()
```

輸出：

<img src="res/box_plot_2.png" style="zoom:75%;">

> **說明**：箱線圖中的小圓圈用來表示離群點，也就是大於 $\small{Q_3 + 1.5 \times IQR}$ 或小於 $\small{Q_1 - 1.5 \times IQR}$ 的值。公式中的常量 1.5 可以透過繪製箱線圖的`boxplot`函式的`whis`引數進行修改，常用的值是 1.5 和 3，修改為 3 通常是為了標識出極度離群點。

需要說明的是，NumPy 的陣列物件並沒有提供計算幾何平均值、調和平均值、去尾平均值等的方法，如果有這方面的需求，可以使用名為 scipy 的三方庫，它的`stats`模組中提供了這些函式。此外，該模組還提供了計算眾數、變異係數、偏態、峰度的函式，程式碼如下所示。

程式碼：

```python
from scipy import stats

print(np.mean(array1))                # 算術平均值
print(stats.gmean(array1))            # 幾何平均值
print(stats.hmean(array1))            # 調和平均值
print(stats.tmean(array1, [10, 90]))  # 去尾平均值
print(stats.variation(array1))        # 變異係數
print(stats.skew(array1))             # 偏態係數
print(stats.kurtosis(array1))         # 峰度係數
```

輸出：

```
46.0
36.22349548825599
24.497219530825497
45.0
0.5547526228777941
0.11644192634527782
-0.7106251396024126
```

#### 其他相關方法概述

1. `all()` / `any()`方法：判斷陣列是否所有元素都是`True` / 判斷陣列是否有為`True`的元素。

2. `astype()`方法：複製陣列，並將陣列中的元素轉換為指定的型別。

3. `reshape()`方法：調整陣列物件的形狀。

4. `dump()`方法：儲存陣列到二進位制檔案中，可以透過 NumPy 中的`load()`函式從儲存的檔案中載入資料建立陣列。

    程式碼：

    ```Python
    array.dump('array1-data')
    array3 = np.load('array1-data', allow_pickle=True)
    array3
    ```

    輸出：

    ```
    array([46, 51, 15, 42, 53, 71, 20, 62,  6, 94])
    ```

5. `tofile()`方法：將陣列物件寫入檔案中。

   ```Python
   array1.tofile('array.txt', sep=',')
   ```

6. `fill()`方法：向陣列中填充指定的元素。

7. `flatten()`方法：將多維陣列扁平化為一維陣列。

    程式碼：

    ```Python
    array2.flatten()
    ```

    輸出：

    ```
    array([1, 2, 3, 4, 5, 6, 7, 8, 9])
    ```

8. `nonzero()`方法：返回非0元素的索引。

9. `round()`方法：對陣列中的元素做四捨五入操作。

10. `sort()`方法：對陣列進行就地排序。

    程式碼：

    ```Python
    array1.sort()
    array1
    ```

    輸出：

    ```
    array([ 6, 15, 20, 42, 46, 51, 53, 62, 71, 94])
    ```

11. `swapaxes()`和`transpose()`方法：交換陣列指定的軸和轉置。

    程式碼：

    ```Python
    array2.swapaxes(0, 1)
    ```

    輸出：

    ```
    array([[1, 4, 7],
           [2, 5, 8],
           [3, 6, 9]])
    ```

    程式碼：

    ```Python
    array2.transpose()
    ```

    輸出：

    ```
    array([[1, 4, 7],
           [2, 5, 8],
           [3, 6, 9]])
    ```

12. `tolist()`方法：將陣列轉成 Python 中的`list`。

    程式碼：

    ```Python
    print(array2.tolist())
    print(type(array2.tolist()))
    ```

    輸出：

    ```
    [[1, 2, 3], [4, 5, 6], [7, 8, 9]]
    <class 'list'>
    ```
